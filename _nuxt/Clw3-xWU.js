import B from"./C7WIyLEr.js";import{g as m,p as R,r as u,s as V,E as g,c as F,a as Y,aa as s,aB as y,x as h,ar as N,o as O,aE as j,aF as x,b as z,am as _}from"./CrXR3okT.js";import{u as q}from"./jNIH7rGV.js";import{u as H,a as M}from"./cZpgtiaa.js";function Q(d){let i=Promise.resolve();const n=H("youtubePlayer",()=>({scriptInput:{src:"https://www.youtube.com/iframe_api",crossorigin:!1},scriptOptions:{use(){return{YT:window.YT||i.then(()=>window.YT)}}},clientInit:()=>{i=new Promise(e=>{window.onYouTubeIframeAPIReady=e})}}),d);{const e=m(n.status,l=>{l==="loading"&&(M({link:[{rel:"preconnect",href:"https://www.youtube-nocookie.com"},{rel:"preconnect",href:"https://www.google.com"},{rel:"preconnect",href:"https://googleads.g.doubleclick.net"},{rel:"preconnect",href:"https://static.doubleclick.net"}]}),e())})}return n}const J=R({__name:"ScriptYouTubePlayer",props:{placeholderAttrs:{},rootAttrs:{},aboveTheFold:{type:Boolean},trigger:{type:[String,Array,Boolean],default:"mousedown"},videoId:{},playerVars:{default:{autoplay:0,playsinline:1}},width:{default:640},height:{default:480}},emits:["ready","state-change","playback-quality-change","playback-rate-change","error"],setup(d,{expose:i,emit:n}){const e=d,l=n,A=["onReady","onStateChange","onPlaybackQualityChange","onPlaybackRateChange","onError","onApiChange"],f=u(),w=u(),b=u(!1),r=q({trigger:e.trigger,el:f}),E=Q({scriptOptions:{trigger:r}}),{onLoaded:I,status:a}=E,c=u();let p=!1;e.trigger==="mousedown"&&r instanceof Promise&&r.then(t=>{t&&(p=!0)}),V(()=>{I(async t=>{const P=t.YT instanceof Promise?await t.YT:t.YT;await new Promise(o=>{typeof YT.Player>"u"?P.ready(o):o()}),c.value=new YT.Player(w.value,{...e,events:Object.fromEntries(A.map(o=>[o,L=>{var k;const S=o.replace(/([A-Z])/g,"-$1").replace("on-","").toLowerCase();l(S,L),o==="onReady"&&(b.value=!0,p&&((k=c.value)==null||k.playVideo(),p=!1),m(()=>e.videoId,()=>{var T;(T=c.value)==null||T.loadVideoById(e.videoId)}))}]))})}),m(a,t=>{t==="error"&&l("error")})}),i({player:c});const $=g(()=>_(e.rootAttrs,{"aria-busy":a.value==="loading","aria-label":a.value==="awaitingLoad"?"YouTube Player - Placeholder":a.value==="loading"?"YouTube Player - Loading":"YouTube Player - Loaded","aria-live":"polite",role:"application",style:{cursor:"pointer",position:"relative",backgroundColor:"black",maxWidth:"100%",width:`${e.width}px`,height:"auto",aspectRatio:`${e.width}/${e.height}`},...r instanceof Promise?r.ssrAttrs||{}:{}})),v=g(()=>`https://i.ytimg.com/vi_webp/${e.videoId}/sddefault.webp`),C=g(()=>_(e.placeholderAttrs,{src:v.value,alt:"",loading:e.aboveTheFold?"eager":"lazy",style:{width:"100%",objectFit:"contain",height:"100%"}}));return(t,P)=>{const o=B;return O(),F("div",N({ref_key:"rootEl",ref:f},$.value),[Y("div",{ref_key:"youtubeEl",ref:w,style:{width:"100%",height:"100%",position:"absolute",top:"0",left:"0"}},null,512),b.value?y("",!0):s(t.$slots,"placeholder",{key:0,placeholder:v.value},()=>[Y("img",j(x(C.value)),null,16)]),h(a)==="loading"?s(t.$slots,"loading",{key:1},()=>[z(o)]):y("",!0),h(a)==="awaitingLoad"?s(t.$slots,"awaitingLoad",{key:2}):h(a)==="error"?s(t.$slots,"error",{key:3}):y("",!0),s(t.$slots,"default")],16)}}});export{J as default};
